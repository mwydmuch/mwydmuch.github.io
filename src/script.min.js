/*!
 * mwydmuch.pl v0.0.2
 * Copyright 2021 Marek Wydmuch
 */

var canvas=document.getElementById("background"),ctx=canvas.getContext("2d",{alpha:!1}),container=document.getElementById("container");ctx.canvas.width=Math.max(container.offsetWidth,window.innerWidth),ctx.canvas.height=Math.max(container.offsetHeight,window.innerHeight),ctx.fillStyle="#FFFFFF",ctx.fillRect(0,0,canvas.width,canvas.height);var fps=15,fpsInterval=1e3/fps,then=Date.now(),colors=["#777777","#888888","#999999","#AAAAAA"];class GameOfLife{constructor(t,i){this.ctx=canvas.getContext("2d",{alpha:!1}),this.cellSize=i,this.gridWidth=0,this.gridHeight=0,this.grid=null,this.gridNextState=null,this.resize()}getCord(t,i){return t+i*this.gridWidth}update(t){for(let i=0;i<this.gridHeight;++i)for(let t=0;t<this.gridWidth;++t){var e=this.isAlive(t-1,i-1)+this.isAlive(t,i-1)+this.isAlive(t+1,i-1)+this.isAlive(t-1,i)+this.isAlive(t+1,i)+this.isAlive(t-1,i+1)+this.isAlive(t,i+1)+this.isAlive(t+1,i+1),s=this.getCord(t,i);2==e&&1==this.grid[s]?this.gridNextState[s]=this.grid[s]:this.gridNextState[s]=3==e?1:this.grid[s]-1}[this.grid,this.gridNextState]=[this.gridNextState,this.grid]}isAlive(t,i){return!(t<0||t>=this.gridWidth||i<0||i>=this.gridHeight)&&(1==this.grid[this.getCord(t,i)]?1:0)}draw(){this.ctx.fillStyle="#FFFFFF",this.ctx.fillRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height);for(let e=0;e<this.gridHeight;++e)for(let i=0;i<this.gridWidth;++i){var s=this.grid[this.getCord(i,e)],h=1-Math.min(0,s);let t=null;0<=s?t=colors[0]:-1==s?t=colors[1]:-2==s?t=colors[2]:-3==s&&(t=colors[3]),t&&(this.ctx.fillStyle=t,this.ctx.fillRect(i*this.cellSize+h,e*this.cellSize+h,this.cellSize-2*h,this.cellSize-2*h))}}resize(){console.log("resize",this.ctx.canvas.width,this.ctx.canvas.height);var e=Math.ceil(this.ctx.canvas.width/this.cellSize),t=Math.ceil(this.ctx.canvas.height/this.cellSize);let s=new Array(e*t);for(let i=0;i<t;i++)for(let t=0;t<e;t++){var h=t+i*e;t<this.gridWidth&&i<this.gridHeight?s[h]=this.grid[this.getCord(t,i)]:s[h]=.5<Math.random()?1:0}this.grid=s,this.gridNextState=[...this.grid],this.gridWidth=e,this.gridHeight=t}}var animation=new GameOfLife(canvas,10);function onResize(){ctx.canvas.width=Math.max(container.offsetWidth,window.innerWidth),ctx.canvas.height=Math.max(container.offsetHeight,window.innerHeight),animation.resize()}function checkResize(t,i){for(mutation of t)console.log(mutation)}window.addEventListener("resize",onResize);var observer=new MutationObserver(checkResize);function render(){requestAnimationFrame(render);var t=Date.now(),i=t-then;i<fpsInterval||(then=t,animation.update(i),animation.draw())}render();